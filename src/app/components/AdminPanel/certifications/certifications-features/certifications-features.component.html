<div *ngIf="courseFeatures() as courseFeatures">
  <div *ngIf="courseFeatures.length === 0" class="d-flex flex-column align-items-center text-center gap-2 py-4">
    <i class="bi bi-list-check fs-2 text-secondary"></i>
    <span class="text-muted">
      No course features found for this certification yet.
    </span>
    <span class="courseLink fw-semibold" role="button" tabindex="0" (click)="AddFeatures()">
      + Add Course Features
    </span>
  </div>

  <div *ngIf="courseFeatures.length > 0" class="row g-3">
    <div *ngFor="let feature of courseFeatures; let i = index" class="col-12">
      <div class="d-flex align-items-center justify-content-between">
        <div class="d-flex align-items-center">
          <span class="d-flex align-items-center">
            <i class="bi bi-pin pe-1"></i>
             <strong class="pe-1">{{ feature.featureHeader }}:</strong>
             </span>
          <span>{{ feature.featureDescription }}</span>
        </div>
        <div class="d-flex align-items-center gap-2">
          <i class="bi bi-trash" (click)="deleteFeature(feature)"></i>
          <i class="bi bi-pencil-square" (click)="editFeature(feature)"></i>
        </div>
      </div>
    </div>

    <div class="addAnswer d-flex align-items-center justify-content-end mt-2"
    (click)="AddFeature(courseFeatures.length)" style="cursor: pointer">
      <i class="bi bi-plus-circle-fill pe-2"></i>
      <span>Add Feature</span>
    </div>
  </div>
</div>

<form [formGroup]="form" (ngSubmit)="onSubmit()">
  <div
    class="modal fade"
    id="CertificationModal"
    tabindex="-1"
    aria-labelledby="CertificationModal"
    aria-hidden="true"
    #certModal
  >
    <div class="modal-dialog">
      <div class="modal-content">
        <div class="modal-header">
          <h1 class="modal-title fs-5" id="exampleModalLabel">
            Add New Features
          </h1>
          <button
            type="button"
            class="btn-close"
            data-bs-dismiss="modal"
            aria-label="Close"
          ></button>
        </div>
        <div class="modal-body px-4 py-2">
          <div class="d-flex flex-column gap-4">
            <div class="row flex-wrap g-3" formArrayName="features">
              @for (group of featureArrays.controls; let i = $index; track i) {
                <div class="border-bottom row g-2 pb-4">
                  <div class="col-12" [formGroupName]="i">
                    <app-input
                      formControlName="featureHeader"
                      [label]="`Feature Header`"
                      type="text"
                      placeholder=""
                      icon=""
                      [errorMessages]="{
                        required: 'Header is required',
                      }"
                    />
                  </div>
                  <div class="col-12" [formGroupName]="i">
                    <app-textarea
                      formControlName="featureDescription"
                      [label]="`Feature Description`"
                      placeholder=""
                      [errorMessages]="{
                        required: 'Description is required',
                      }"
                    ></app-textarea>
                  </div>
                  <div class="col-12" [formGroupName]="i">
                    <app-input
                      formControlName="orderNo"
                      [label]="`Feature Order Number`"
                      type="text"
                      placeholder=""
                      icon=""
                      [errorMessages]="{
                        required: 'Order No is required',
                      }"
                    />
                  </div>
                </div>
              }
            </div>
          </div>
          <div
            class="addAnswer d-flex align-items-center justify-content-end mt-2"
            (click)="onAddAnotherFeature()"
            style="cursor: pointer"
          >
            <i class="bi bi-plus-circle-fill pe-2"></i>
            <span>Add Another Feature</span>
          </div>
        </div>
        <div class="modal-footer">
          <app-button
            data-bs-dismiss="modal"
            btnLabel="Close"
            [mainBtn]="false"
            [secondaryBtn]="true"
          />
          <app-button btnLabel="Save" [mainBtn]="true" buttonType="submit" />
        </div>
      </div>
    </div>
  </div>
</form>



<!-- <div *ngIf="courseFeatures() as features">
  <div *ngIf="features.length === 0" class="text-center py-4">
    <i class="bi bi-list-check fs-2 text-secondary"></i>
    <p class="text-muted mt-2">No features yet</p>
    <span class="fw-semibold cursor-pointer" (click)="openAddModal()">+ Add Feature</span>
  </div>

  <div *ngIf="features.length > 0" class="row g-3">
    @for (feature of features; track feature.oid) {
      <div class="col-12">
        <div class="d-flex align-items-center justify-content-between">
          <div class="d-flex align-items-center">
            <span class="badge bg-light me-2">{{ feature.orderNo }}</span>
            <strong>{{ feature.featureHeader }}</strong>
            <span class="text-muted ms-2">{{ feature.featureDescription }}</span>
          </div>
          <div class="d-flex gap-2">
            <i class="bi bi-pencil-square text-primary cursor-pointer" (click)="openEditModal(feature)"></i>
            <i class="bi bi-trash text-danger cursor-pointer" (click)="deleteFeature(feature)"></i>
          </div>
        </div>
      </div>
    }
    <div class="text-end mt-3">
      <span class="fw-semibold cursor-pointer" (click)="openAddModal()">+ Add Feature</span>
    </div>
  </div>
</div>

<app-generic-modal
  [isOpen]="showModal()"
  [title]="modalTitle()"
  (close)="closeModal()"
>
  <app-generic-form-array
    [formFactory]="formFactory"
    [initialItems]="initialFeatures()"
    [entityName]="'Feature'"
    [minRows]="1"
    [allowAddMore]="true"
    (submit)="saveFeatures($event)"
    (cancel)="closeModal()"
  >
    <ng-template #row let-group let-idx="$index">
      <div class="row g-3">

        <div class="col-12">
          <app-input
            formControlName="featureHeader"
            label="Feature Header"
            placeholder="e.g. Hands-on Projects"
          />
        </div>

        <div class="col-12">
          <app-textarea
            formControlName="featureDescription"
            label="Feature Description"
            [rows]="3"
          />
        </div>

        <div class="col-12">
          <app-input
            type="number"
            formControlName="orderNo"
            label="Display Order"
          />
        </div>

      </div>
    </ng-template>
  </app-generic-form-array>
</app-generic-modal> -->

<!-- <app-certification-common
  [items]="courseFeatures"
  [entityName]="entityName"
  [formFactory]="formFactory"
  [createFn]="createFeature"
  [updateFn]="updateFeature"
  [deleteFn]="deleteFeatureFn"
>


  <div item class="d-flex align-items-center justify-content-between py-3 border-bottom">

    <div class="d-flex align-items-center gap-3 flex-grow-1">
      <span class="badge bg-light text-dark px-3 py-1 fw-medium">
        Order
      </span>
      <div>
        <strong class="d-block">Feature Header</strong>
        <small class="text-muted">Feature description placeholder</small>
      </div>
    </div>
  </div>

  <div form  class="row g-3">
    <div class="col-12">
      <app-input
        formControlName="featureHeader"
        label="Feature Header"
        type="text"
        placeholder="e.g. Hands-on Projects, Real-World Scenarios"
        [errorMessages]="{ required: 'Feature header is required' }"
      />
    </div>

    <div class="col-12">
      <app-textarea
        formControlName="featureDescription"
        label="Feature Description"
        [rows]="3"
        placeholder="Describe what the learner will gain or experience..."
        [errorMessages]="{ required: 'Description is required' }"
      />
    </div>

    <div class="col-12">
      <app-input
        formControlName="orderNo"
        label="Display Order"
        type="number"
        [errorMessages]="{ required: 'Order number is required' }"
      />
    </div>
  </div>

</app-certification-common> -->
